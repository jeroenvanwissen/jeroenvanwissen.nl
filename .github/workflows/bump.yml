name: Bump version

on:
    push:
        branches:
            - main
        paths-ignore:
            - 'package.json'
            - 'CHANGELOG.md'

jobs:
    build:
        runs-on: ubuntu-latest
        permissions:
            contents: write

        steps:
            - uses: actions/checkout@v4
              with:
                  fetch-depth: 0
                  fetch-tags: true
                  persist-credentials: false
                  token: ${{ secrets.GITHUB_TOKEN }}

            - name: Bump version and push tag
              uses: TriPSs/conventional-changelog-action@v6
              with:
                  github-token: ${{ secrets.GITHUB_TOKEN }}
                  git-message: 'chore(release): {version}'
                  preset: 'angular'
                  tag-prefix: 'v'
                  output-file: 'CHANGELOG.md'
                  git-user-name: 'Conventional Changelog Action'
                  git-user-email: 'conventional.changelog.action@github.com'
                  git-pull-method: '--ff-only'
                  git-push: 'true'
                  release-count: '5'
                  version-file: './package.json'
                  version-path: 'version'
                  skip-on-empty: 'false'
                  skip-version-file: 'false'
                  skip-commit: 'false'
                  fallback-version: '0.1.0'
